data(gapminder)
head(gapminder)
library(dslabs)
data(gapminder)
head(gapminder)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidymodels)
salary_dataset = read.csv("salary.csv")
salary_dataset =  salary_dataset %>% select(-X)
set.seed(24)
split = initial_split(salary_dataset, prop = 0.8, strata = Salary)
salary_train = split %>% training()
salary_test = split %>% testing()
hasil_model = lm (
Salary ~ YearsExperience,
data = salary_train
)
summary(hasil_model)
hasil_prediksi = predict(hasil_model,salary_test)
salary_test %>% mutate(hasil = hasil_prediksi)
library(dslabs)
data(gapminder)
head(gapminder)
View(gapminder)
gapminder$infant_mortality[is.na(gapminder$infant_mortality)] = mean (
gapminder$infant_mortality, na.rm = TRUE)
gapminder$fertility[is.na(gapminder$fertility)] = mean (
gapminder$fertility, na.rm = TRUE)
gapminder$gdp[is.na(gapminder$gdp)] = mean (
gapminder$gdp, na.rm = TRUE)
gapminder_2004 = gapminder %>%
filter(year == 2004) %>%
select(-year, -continent, -region)
head(gapminder_2004)
gapminder_2004_scaled = gapminder_2004 %>%
select(-country) %>%
scale()
head(gapminder_2004_scaled)
set.seed(42)
kmeans_result = kmeans(
gapminder_2004_scaled,
center = 3,
nstart = 25
)
gapminder_2004$cluster = kmeans_result
set.seed(42)
kmeans_result = kmeans(
gapminder_2004_scaled,
center = 3,
nstart = 25
)
gapminder_2004$cluster = as.factor(kmeans_result$cluster)
head(gapminder_2004)
View(gapminder_2004_scaled)
View(gapminder_2004)
wss = sapply(1:10, function(k){
set.seed(42)
kmeans(
gapminder_2004_scaled,
center = k,
nstart = 25
)$tot.withinss
})
elbow_data = data.frame(
k = 1:10,
wss = wss
)
ggplot(
data = elbow_data,
aes(
x = k,
y = wss
)
) + geom_line(
color = "blue"
) + geom_point(
color = "red"
)
set.seed(42)
kmeans_result = kmeans(
gapminder_2004_scaled,
center = 4,
nstart = 25
)
gapminder_2004$cluster = as.factor(kmeans_result$cluster)
head(gapminder_2004)
wss = sapply(1:10, function(k){
set.seed(42)
kmeans(
gapminder_2004_scaled,
center = k,
nstart = 25
)$tot.withinss
})
elbow_data = data.frame(
k = 1:10,
wss = wss
)
ggplot(
data = elbow_data,
aes(
x = k,
y = wss
)
) + geom_line(
color = "blue"
) + geom_point(
color = "red"
)
ggplot(
gapminder_2004,
aes(
x = gdp,
y = life_expectancy,
color = cluster
)
) +geom_point()
ggplot(
gapminder_2004,
aes(
x = gdp,
y = life_expectancy,
color = cluster
)
) +geom_point() + scale_x_log10()
ggplot(
gapminder_2004,
aes(
y = gdp,
x = life_expectancy,
color = cluster
)
) +geom_point()
ggplot(
gapminder_2004,
aes(
x = gdp,
y = life_expectancy,
color = cluster
)
) +geom_point() + scale_x_log10()
set.seed(123)
kmeans_result = kmeans(
gapminder_2004_scaled,
center = 4,
nstart = 25
)
gapminder_2004$cluster = as.factor(kmeans_result$cluster)
head(gapminder_2004)
wss = sapply(1:10, function(k){
set.seed(123)
kmeans(
gapminder_2004_scaled,
center = k,
nstart = 25
)$tot.withinss
})
elbow_data = data.frame(
k = 1:10,
wss = wss
)
ggplot(
data = elbow_data,
aes(
x = k,
y = wss
)
) + geom_line(
color = "blue"
) + geom_point(
color = "red"
)
ggplot(
gapminder_2004,
aes(
x = gdp,
y = life_expectancy,
color = cluster
)
) +geom_point() + scale_x_log10()
